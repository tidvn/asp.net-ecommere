@model TDStore.Areas.Store.Models.ProductView
<section class="item-details section">
    <div class="container">
        <div class="top-area">
            <div class="row align-items-center">
                <div class="col-lg-6 col-md-12 col-12">
                    <div class="product-images">
                        <main id="gallery">
                            <div class="main-img">
                                <img data-pagespeed-high-res-src="data:@Model.Images[0].FileType;base64,@Convert.ToBase64String(Model.Images[0].Data)"
                                     id="current" alt="#" data-pagespeed-url-hash="4064215021" src="data:@Model.Images[0].FileType;base64,@Convert.ToBase64String(Model.Images[0].Data)"
                                     onload="pagespeed.switchToHighResAndMaybeBeacon(this);" onerror="this.onerror=null;pagespeed.switchToHighResAndMaybeBeacon(this);">
                                @*<img alt="#" src="data:@Model.Images[0].FileType;base64,@Convert.ToBase64String(Model.Images[0].Data)" >*@

                            </div>
                            <div class="images">
                                @foreach (var img in Model.Images)
                                {
                                    @*<img alt="#" src="data:@img.FileType;base64,@Convert.ToBase64String(img.Data)" class="img" alt="#" >*@
                                    <img data-pagespeed-high-res-src="data:@img.FileType;base64,@Convert.ToBase64String(img.Data)" class="img" alt="#"
                                         data-pagespeed-url-hash="652747488" src="data:@img.FileType;base64,@Convert.ToBase64String(img.Data)" onload="pagespeed.switchToHighResAndMaybeBeacon(this);"
                                         onerror="this.onerror=null;pagespeed.switchToHighResAndMaybeBeacon(this);"  style="opacity: 1;">

                                }
                            </div>
                        </main>
                    </div>
                </div>
                <div class="col-lg-6 col-md-12 col-12">
                    <div class="product-info">
                        <h2 class="title">@Model.Name</h2>
                        <p class="category">
                            <i class="lni lni-tag"></i> Tag:
                            @foreach (var cate in Model.Category)
                            {
                                <a>
                                @cate.Name,
                                </a>
                            }
                            
                        </p>
                        <h3 class="price" id="price"> @{ if (Model.List_Inventory[0].Price != Model.List_Inventory[0].Price-(Model.List_Inventory[0].Price * Model.List_Inventory[0].Discount_Percent )/100){<span> @Model.List_Inventory[0].Price </span> }}  @(Model.List_Inventory[0].Price-(Model.List_Inventory[0].Price * Model.List_Inventory[0].Discount_Percent )/100) VNĐ</h3>
                        <p class="info-text">
                            @Model.Details
                        </p>
                        <div class="row">
                            @* <div class="col-lg-4 col-md-4 col-12">
                            <div class="form-group color-option">
                            <label class="title-label" for="size">Choose color</label>
                            <div class="single-checkbox checkbox-style-1">
                            <input type="checkbox" id="checkbox-1" checked="">
                            <label for="checkbox-1"><span></span></label>
                            </div>
                            <div class="single-checkbox checkbox-style-2">
                            <input type="checkbox" id="checkbox-2">
                            <label for="checkbox-2"><span></span></label>
                            </div>
                            <div class="single-checkbox checkbox-style-3">
                            <input type="checkbox" id="checkbox-3">
                            <label for="checkbox-3"><span></span></label>
                            </div>
                            <div class="single-checkbox checkbox-style-4">
                            <input type="checkbox" id="checkbox-4">
                            <label for="checkbox-4"><span></span></label>
                            </div>
                            </div>
                            </div> *@
                            <div class="col-lg-4 col-md-4 col-12">
                                <div class="form-group">
                                    <label for="Invname">Choose One to Buy</label>
                                    <select class="form-control" id="Invname">
                                        @foreach (var item in Model.List_Inventory)
                                        {
                                            <option value="@item.Id" data-price="@item.Price" data-discount="@item.Discount_Percent">@item.Name</option>
                                        }


                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-4 col-md-4 col-12">
                                <div class="form-group">
                                    <label for="quantily">Quantity</label>
                                    <input class="form-control" id="quantily" type="number" value="1">
                                </div>
                            </div>
                        </div>
                        <div class="bottom-content">
                            <div class="row align-items-end">
                                <div class="col-lg-4 col-md-4 col-12">
                                    <div class="button cart-button">
                                        
                                        <button id="addToCart" class="btn" style="width: 100%;">Add to Cart</button>
                                    </div>
                                </div>
                                @* <div class="col-lg-4 col-md-4 col-12">
                                <div class="wish-button">
                                <button class="btn"><i class="lni lni-reload"></i> Compare</button>
                                </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-12">
                                <div class="wish-button">
                                <button class="btn"><i class="lni lni-heart"></i> To Wishlist</button>
                                </div>
                                </div> *@
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="product-details-info">
            <div class="single-block">
                <div class="row">
                    <div class="col-lg-6 col-12">
                        <div class="info-body custom-responsive-margin">
                            @* <h4>Details</h4>
                            <p>
                               @Model.Details
                            </p> *@
                            <h4>Features</h4>
                            @Model.Features
                            @* <ul class="features">
                                <li>Capture 4K30 Video and 12MP Photos</li>
                                <li>Game-Style Controller with Touchscreen</li>
                                <li>View Live Camera Feed</li>
                                <li>Full Control of HERO6 Black</li>
                                <li>Use App for Dedicated Camera Operation</li>
                            </ul>  *@
                        </div>
                    </div>
                    <div class="col-lg-6 col-12">
                        <div class="info-body">
                            <h4>Specifications</h4>
                            <ul class="normal-list">
                                @foreach (KeyValuePair<string, string> s  in Model.List_Specifications)
                                {
                                    <li><span>@s.Key :</span> @s.Value</li>
                                }
                                
                                @* <li><span>Maximum Speed:</span> 35 mph (15 m/s)</li>
                                <li><span>Maximum Distance:</span> Up to 9,840ft (3,000m)</li>
                                <li><span>Operating Frequency:</span> 2.4GHz</li>
                                <li><span>Manufacturer:</span> GoPro, USA</li> *@
                            </ul>
                            @* <h4>Shipping Options:</h4>
                            <ul class="normal-list">
                                <li><span>Courier:</span> 2 - 4 days, $22.50</li>
                                <li><span>Local Shipping:</span> up to one week, $10.00</li>
                                <li><span>UPS Ground Shipping:</span> 4 - 6 days, $18.00</li>
                                <li><span>Unishop Global Export:</span> 3 - 4 days, $25.00</li>
                            </ul> *@
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4 col-12">
                    <div class="single-block give-review">
                        <h4>4.5 (Overall)</h4>
                        <ul>
                            <li>
                                <span>5 stars - 38</span>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star-filled"></i>
                            </li>
                            <li>
                                <span>4 stars - 10</span>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star"></i>
                            </li>
                            <li>
                                <span>3 stars - 3</span>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star"></i>
                                <i class="lni lni-star"></i>
                            </li>
                            <li>
                                <span>2 stars - 1</span>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star"></i>
                                <i class="lni lni-star"></i>
                                <i class="lni lni-star"></i>
                            </li>
                            <li>
                                <span>1 star - 0</span>
                                <i class="lni lni-star-filled"></i>
                                <i class="lni lni-star"></i>
                                <i class="lni lni-star"></i>
                                <i class="lni lni-star"></i>
                                <i class="lni lni-star"></i>
                            </li>
                        </ul>

                        <button type="button" class="btn review-btn" data-bs-toggle="modal" data-bs-target="#exampleModal">
                            Leave a Review
                        </button>
                    </div>
                </div>
                <div class="col-lg-8 col-12">
                    <div class="single-block">
                        <div class="reviews">
                            <h4 class="title">Latest Reviews</h4>

                            <div class="single-review">
                                <img alt="#" src="~/Shopgrids/images/profile/xcomment1.jpg">
                                <div class="review-info">
                                    <h4>
                                        Awesome quality for the price
                                        <span>
                                            Jacob Hammond
                                        </span>
                                    </h4>
                                    <ul class="stars">
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                    </ul>
                                    <p>
                                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                                        tempor...
                                    </p>
                                </div>
                            </div>


                            <div class="single-review">
                                <img alt="#" src="~/Shopgrids/images/profile/xcomment2.jpg">
                                <div class="review-info">
                                    <h4>
                                        My husband love his new...
                                        <span>
                                            Alex Jaza
                                        </span>
                                    </h4>
                                    <ul class="stars">
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star"></i></li>
                                    </ul>
                                    <p>
                                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                                        tempor...
                                    </p>
                                </div>
                            </div>


                            <div class="single-review">
                                <img alt="#" src="~/Shopgrids/images/profile/xcomment3.jpg">
                                <div class="review-info">
                                    <h4>
                                        I love the built quality...
                                        <span>
                                            Jacob Hammond
                                        </span>
                                    </h4>
                                    <ul class="stars">
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                        <li><i class="lni lni-star-filled"></i></li>
                                    </ul>
                                    <p>
                                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                                        tempor...
                                    </p>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script type="text/javascript">
$('#Invname').on('change', function() {
  const selectedOption = event.target.options[event.target.selectedIndex];
  const price = selectedOption.getAttribute('data-price');
  const discount = price-selectedOption.getAttribute('data-discount')*0.01*price  ;
    if(discount != price){
    $('#price').html(`<span>${price}</span>${discount} VNĐ`)
    }else{
     $('#price').html(`${price}`)   
    }
 
});



    $(function () {

        $("#addToCart").click(function () {
            var url = window.location.pathname;
            var idProduct = url.substring(url.lastIndexOf('/') + 1)    
            var idInventory = $("#Invname").find(":selected").val();
            var quantily = $("#quantily").val();

            var formData = {
                idProduct: idProduct,
                idInventory: idInventory,
                quantily : quantily

            };
            console.log(formData)
            if (quantily > 0) {
                // Perform the ajax post
                $.ajax({
                type: 'POST',
                url: '@Url.Action("AddToCart", "Cart")',
                data: JSON.stringify(formData),
                contentType: 'application/json',
                dataType: 'json',
                encode: true
            }).done(function (data) {
                    if (data.success) {
                      alert("Đã Thêm Vào Giỏ Hàng")
                    } else {
                        alert("Đã Hết Hàng")
                    }
                });
            }
            
        });


        var imgMain = document.querySelector('img#current')
        var imgElement = document.querySelectorAll('img.img')
        for (let i in imgElement) {
            imgElement[i].addEventListener("click", (e) => {
                imgMain.src = imgElement[i].dataset.pagespeedHighResSrc;
                imgElement[i].style.opacity = '0.6';
                console.log(imgElement[i].src)
            })
            imgElement[i].addEventListener('mouseout', (e) => {
                imgElement[i].style.opacity = '1';
                console.log(imgElement[i].src)
            });
            
        }

    });
</script>